(function(r){typeof define=="function"&&define.amd?define(r):r()})((function(){"use strict";var g=r=>{throw TypeError(r)};var m=(r,o,i)=>o.has(r)||g("Cannot "+i);var n=(r,o,i)=>(m(r,o,"read from private field"),i?i.call(r):o.get(r)),d=(r,o,i)=>o.has(r)?g("Cannot add the same private member more than once"):o instanceof WeakSet?o.add(r):o.set(r,i),p=(r,o,i,c)=>(m(r,o,"write to private field"),c?c.call(r,i):o.set(r,i),i),h=(r,o,i)=>(m(r,o,"access private method"),i);var o,i,c,a,s,L,f,w,E,y,C,I,b,S,T,k,v,x,A;class r extends HTMLElement{constructor(){super();d(this,s);d(this,o);d(this,i);d(this,c,[]);d(this,a)}connectedCallback(){this.innerHTML=`
			<div class="screen">
				<div class="output">
				</div>
				<textarea class="input" rows="1"></textarea>
			</div>
		`,p(this,o,this.querySelector(".output")),p(this,a,{resolve:()=>{},reject:()=>{}}),p(this,i,this.querySelector(".input")),h(this,s,L).call(this),requestAnimationFrame(()=>{this.dispatchEvent(new CustomEvent("ready"))})}out(t,e=""){const u=h(this,s,v).call(this,t,e);n(this,o).appendChild(u),this.scrollTo(0,this.scrollHeight)}outError(t){this.out(t,"error")}outWarning(t){this.out(t,"warning")}outWarn(t){this.outWarning(t)}outSuccess(t){this.out(t,"success")}outInfo(t){this.out(t,"info")}outDebug(t){this.out(t,"debug")}in(t){return t&&this.out(t),new Promise((e,u)=>{if(n(this,c).length==0)p(this,a,{resolve:e,reject:u});else{const l=n(this,c).shift();this.out(l),e(l),h(this,s,f).call(this,"input",{firstInput:l,inputs:l}),h(this,s,x).call(this)}})}open(t){const e=t==null||t==null?`
ObsiCLI was opened correctly.`:t;this.out(e),n(this,i).removeAttribute("disabled"),n(this,i).focus(),h(this,s,f).call(this,"opened")}close(t){const e=t==null||t==null?`
ObsiCLI was closed correctly.`:t;h(this,s,A).call(this),this.out(e),n(this,i).setAttribute("disabled","disabled"),n(this,i).value="",h(this,s,f).call(this,"closed")}clear(){n(this,o).innerHTML="",n(this,i).value="",n(this,i).focus()}}o=new WeakMap,i=new WeakMap,c=new WeakMap,a=new WeakMap,s=new WeakSet,L=function(){this.addEventListener("click",h(this,s,w).bind(this)),n(this,i).addEventListener("keydown",h(this,s,E).bind(this)),n(this,i).addEventListener("paste",h(this,s,y).bind(this)),n(this,i).addEventListener("input",h(this,s,C).bind(this))},f=function(t,e={}){const u=new CustomEvent(t,{detail:e});this.dispatchEvent(u)},w=function(){requestAnimationFrame(()=>{const t=window.getSelection();let e=!1;t.isCollapsed||t.anchorNode.parentNode.closest("obsi-cli")===this&&(e=!0),e||n(this,i).focus()})},E=function(t){t.key==="Enter"&&(t.preventDefault(),t.ctrlKey?h(this,s,I).call(this):h(this,s,T).call(this))},y=function(t){const e=(t.clipboardData||window.clipboardData).getData("text");h(this,s,b).call(this,e)},C=function(t){t.stopPropagation(),h(this,s,b).call(this,t.target.value)},I=function(){let t=n(this,i).value,e=n(this,i).selectionStart;const u=t.substring(0,e),l=t.substring(e,t.length);t=`${u}
${l}`,e++,n(this,i).value=t,h(this,s,b).call(this,t),n(this,i).setSelectionRange(e,e)},b=function(t){const e=(t.match(/\r\n|\r|\n/g)||[]).length;n(this,i).setAttribute("rows",e+1),this.scrollTo(0,this.scrollHeight)},S=function(t){const e=`${t}`.split(/\r?\n|\r/);for(const u of e)n(this,c).push(u)},T=function(){const t=n(this,i).value;h(this,s,S).call(this,t);const e=n(this,c).shift();h(this,s,k).call(this,t),n(this,a).resolve(e),h(this,s,f).call(this,"input",{firstInput:e,inputs:t}),n(this,i).value="",n(this,i).setAttribute("rows",1),p(this,a,{resolve:()=>{},reject:()=>{}})},k=function(t){const e=`${t}`.split(/\r?\n|\r/);this.out(e.shift());for(const u of e){const l=h(this,s,v).call(this,u,"","tmp");n(this,o).appendChild(l)}},v=function(t,e="",u=""){const l=document.createElement("pre");return["error","warning","warn","success","info","debug"].includes(e)&&l.classList.add(e),u&&l.classList.add(u),l.textContent=typeof t=="object"?JSON.stringify(t,null,2):t,l},x=function(){n(this,o).querySelector(".tmp").remove()},A=function(){n(this,o).querySelectorAll(".tmp").forEach(e=>n(this,o).appendChild(e))},customElements.define("obsi-cli",r)}));
